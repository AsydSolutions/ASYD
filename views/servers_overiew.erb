<div class="row">
	<div class="span6">
		<div class="widget widget-table action-table">
			<div class="widget-header">
				<i class="icon-sitemap"></i><h3>Host Groups</h3>
			</div>
			<div class="widget-content">
				<table class="table table-striped">
					<thead>
						<tr>
							<th>
								Name
							</th>
							<th>
								Hosts
							</th>
							<th class="td-actions">
								Actions
							</th>
						</tr>
					</thead>
					<tbody>
						<% @groups.each do |group| %>
						<tr>
							<td>
								<%=group%>
							</td>
							<td>
								<div class="accordion-group accordion-invisible">
									<div class="accordion-heading accordion-invisible">
										<% members_status = check_members_status(group) %>
										<% if members_status[2] == 0 %>
											<a data-toggle="collapse" href="#collapseOne" style="font-size: 8pt; color: #ffffff;" class="badge badge-success"><%=members_status[0]%>/<%=members_status[1]%></a>
										<% else %>
											<a data-toggle="collapse" href="#collapseOne" data-placement="right" data-original-title="<%=members_status[2]%> host(s) on this group has issues" style="font-size: 8pt; color: #ffffff;" class="badge badge-warning hint "><%=members_status[0]%>/<%=members_status[1]%></a>
										<% end %>
									</div>
									<div id="collapseOne" class="accordion-body collapse accordion-invisible">
										<div class="accordion-inner accordion-invisible">
											<% members = get_group_members(group) %>
											<% members.each do |member| %>
												<a href="/server/<%=member%>">
												<% host_ok = all_ok(member) %>
												<% if host_ok == 1 %>
													<span class="label label-success"><%= member %></span>
												<% elsif host_ok == 2 %>
													<span class="label label-warning"><%= member %></span>
												<% elsif host_ok == 3 %>
													<span class="label label-important"><%= member %></span>
												<% end %>
												</a>
											<% end %>
										</div>
									</div>
								</div>
							</td>
							<td class="td-actions">
								<a data-toggle="tooltip" data-original-title="Details" href="/groups/<%=group%>" class="btn btn-mini btn-icon-only hint"><i class="btn-icon-only icon-search"></i></a>
								<a data-toggle="tooltip" data-original-title="Remove" href="#delGroup" class="btn btn-danger btn-mini btn-icon-only hint" onclick="passDataToModal('<%=group%>', '#delGroup')"><i class="btn-icon-only icon-remove"></i></a>
							</td>
						</tr>
						<% end %>
					</tbody>
				</table>
			</div>
		</div>
	</div>
	<div class="span6">
		<div class="widget widget-table action-table">
			<div class="widget-header">
				<i class="icon-hdd"></i><h3>Hosts</h3>
			</div>
			<div class="widget-content">
				<table class="table table-striped">
					<thead>
						<tr>
							<th>
								Hostname
							</th>
							<th>
								Status
							</th>
							<th class="td-actions">
								Actions
							</th>
						</tr>
					</thead>
					<tbody>
						<% @hosts.each do |host| %>
						<tr>
							<td>
								<%=host%>
							</td>
							<td>
								<% host_ok = all_ok(host) %>
								<% if host_ok == 1 %>
	              	<span class="label label-success">all ok</span>
								<% elsif host_ok == 2 %>
									<span class="label label-warning">warning</span>
								<% elsif host_ok == 3 %>
									<span class="label label-important">down</span>
								<% end %>
							</td>
							<td class="td-actions">
								<a data-toggle="tooltip" data-original-title="Details" href="/server/<%=host%>" class="btn btn-mini btn-icon-only hint"><i class="btn-icon-only icon-search"></i></a>
								<a data-toggle="tooltip" data-original-title="Remove" href="#delServer" class="btn btn-danger btn-mini btn-icon-only hint" onclick="passDataToModal('<%=host%>', '#delServer')"><i class="btn-icon-only icon-remove"></i></a>
							</td>
						</tr>
						<% end %>
					</tbody>
				</table>
			</div>
		</div>
	</div>
</div>


<div id="delServer" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
		<h3 id="myModalLabel">Attention!</h3>
	</div>
	<div class="modal-body">
		<p>Are you sure you want to delete <b id="dataInput"></b> from your server list?</p>
	</div>
	<div class="modal-footer">
		<form id="form" id="delGroup" action="/server/del" method="post">
			<input type="hidden" name="host" id="dataInput" value="">
			<div style="float:left" class="control-group"><input type="checkbox" name="revoke" value="true"> Revoke SSH key</div>
			<button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
			<button type="submit" class="btn btn-primary">Delete</button>
		</form>
	</div>
</div>


<div id="delGroup" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
		<h3 id="myModalLabel">Attention!</h3>
	</div>
	<div class="modal-body">
		<p>Are you sure you want to delete <b id="dataInput"></b> hostgroup?</p>
	</div>
	<div class="modal-footer">
		<form id="form" id="delGroup" action="/groups/edit" method="post">
			<input type="hidden" name="action" value="del_group">
			<input type="hidden" name="params[group]" id="dataInput" value="">
			<button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
			<button type="submit" class="btn btn-primary">Delete</button>
		</form>
	</div>
</div>
